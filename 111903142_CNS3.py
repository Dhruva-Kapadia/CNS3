key = "11101110110110101111001110011011100111100110101101010001110000101101111011111111111111001100111010011011100000011111011010011001"
sk1 = int(key[0:16],2)
sk2 = int(key[16:32],2)
sk3 = int(key[32:48],2)
sk4 = int(key[48:64],2)
sk5 = int(key[64:80],2)
sk6 = int(key[80:96],2)

plaintext = "0100000101101101011110000110011000110010011101011111010000100010"
x1 = int(plaintext[0:16],2)
x2 = int(plaintext[16:32],2)
x3 = int(plaintext[32:48],2)
x4 = int(plaintext[48:64],2)

s1 = (x1 * sk1)%65537
s2 = (x2 * sk2)%65536
s3 = (x3 * sk3)%65536
s4 = (x4 * sk4)%65537
s5 = (s1 ^ s3)
s6 = (s2 ^ s4)
s7 = (s5 * sk5)%65537
s8 = (s6 + s7)%65536
s9 = (s8 * sk6)%65537
s10 = (s7 + s9)%65536
s11 = (s1 ^ s9)
s12 = (s3 ^ s9)
s13 = (s2 ^ s10)
s14 = (s4 ^ s10)

ciphertext = bin(s11)[2:] + bin(s12)[2:] + bin(s13)[2:] + bin(s14)[2:]
print(ciphertext)
